# starter-log-http

## 1. Введение

**Название проекта:** starter-log-http  
**Описание:** Spring Boot стартер для логирования всех HTTP-запросов.  
**Цель:** Создать Spring Boot стартер для логирования всех HTTP-запросов, который собирается в JAR и может быть подключен к любому проекту в качестве зависимости.

## 2. Описание проекта

Проект представляет собой простую библиотеку Spring Boot, которая позволяет логировать HTTP-запросы и ответы.

## 3. Структура проекта

### Настройка проекта

- Проект создан с помощью [Spring Initializr](https://start.spring.io/).
- В `pom.xml` добавлены следующие зависимости:
    - `spring-boot-starter-web`
    - `lombok`
    - `spring-boot-starter-test`
    - `spring-boot-configuration-processor`

### Создано 3 класса:

- **LogProperties**  
  Представляет собой конфигурационный бин, аннотированный с помощью `@ConfigurationProperties`. Этот класс автоматически связывает значения из конфигурационных файлов с полями Java-класса.

- **LogHttpFilter**  
  Является фильтром, который используется для перехвата, обработки и логирования входящих HTTP-запросов и исходящих HTTP-ответов. Этот фильтр помогает отслеживать и записывать информацию о запросах и ответах, таких как метод, URL, статус ответа, время обработки.

- **LogHttpAutoConfig**  
  Отвечает за автоматическую конфигурацию логирования HTTP-запросов и ответов в приложении. Он используется для создания и настройки бина `LogHttpFilter`, который отвечает за непосредственное логирование. Этот класс применяется для того, чтобы активировать или деактивировать логирование в зависимости от конфигурационных параметров, заданных в файлах конфигурации (`application.properties` или `application.yml`).

### Настройка стартера (создание автоконфигурации)

Чтобы Spring распознавал конфигурации как автоконфигурации и создавал бин в контексте, необходимо указать файл автоконфигурации в определенном месте. Для этого была создана директория `META-INF` в папке `resources`. Далее была создана директория `spring`, и в ней файл `org.springframework.boot.autoconfigure.AutoConfiguration.imports`.

В этом файле был указан класс автоконфигурации: 
com.klochkov.starter_log_http.log.LogHttpAutoConfig 


После этих действий проект становится стартером и будет автоматически конфигурировать фильтр для логирования.

### Тестирование стартера
Написан тест с частичной загрузкой контекста, который необходим для проверки корректной работы стартера  

### Настройки в `application.yml` (или в `application.properties`):

log:
  http:
    enabled: true
    log-level: INFO
    

(log.http.enabled=true
log.http.log-level=INFO)


### Подключение сстартера к проекту:

1. **Выберите проект для подключения стартеров**

Выбрать проект к которому подключать стартер (как вариант могу предложить проект из предыщего задания на тему AOP, это просто для примера: git clone git@github.com:Klochkov777/aop.git)


2. **Клонируйте проект стартера**
можно склонировать из данного репозитория проект стартера командой: git clone git@github.com:Klochkov777/log-http-starter.git
3. **собрать jar**
собрать его (mvn clean install).
После команды install должен jar оказаться в локальном репозитории и теперь ее можно подключить к любому проекту как зависимость.
<dependency>
<groupId>com.klochkov</groupId>
<artifactId>starter-log-http</artifactId>
<version>0.0.1-SNAPSHOT</version>
</dependency>
(естественно также можно подклбчить как любой jar архив к проекту через ProjectStructure)


## Альтернатиивный вариант
Также я разместил уже собранный jar, который можно скачать указав в браузере следующий путь:
https://github.com/Klochkov777/log-http-starter/releases/download/untagged-a43342b79a5cf65f58cb/starter-log-http-0.0.1-SNAPSHOT.jar
Далее как уже было указано либо ппоместить в локальный репозиторий, либо добавитть как библиотеку через intellij idea (file -> Project Structure -> Libraries -> add и выбрать скаченный jar)

